# Required for whisper-rs-sys (ggml C++): std::filesystem is only available on macOS 10.15+
# Without this, the build fails with: 'path' is unavailable: introduced in macOS 10.15
[env]
MACOSX_DEPLOYMENT_TARGET = "10.15"
CMAKE_OSX_DEPLOYMENT_TARGET = "10.15"
CFLAGS = "-mmacosx-version-min=10.15"
CXXFLAGS = "-mmacosx-version-min=10.15"

# Apple Silicon (aarch64): ggml ARM quants use i8mm (vmmlaq_s32); enable so CI/builds don't fail
[target.aarch64-apple-darwin.env]
CFLAGS = "-mmacosx-version-min=10.15 -march=armv8.2-a+dotprod+i8mm"
CXXFLAGS = "-mmacosx-version-min=10.15 -march=armv8.2-a+dotprod+i8mm"
