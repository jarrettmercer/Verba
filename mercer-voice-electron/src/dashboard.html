<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Verba — Dashboard</title>
    <style>html, body { background: #0a0a0a; color: #fafafa; }</style>
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/dashboard.css" />
</head>
<body>

    <!-- License / activation screen (same size as dashboard; shown when not activated) -->
    <div id="license-screen" class="license-screen" style="display: none;">
        <div class="license-screen-box">
            <h1 class="license-screen-title">Activate Verba</h1>
            <p class="license-screen-hint">Enter your product key to use voice dictation.</p>
            <input type="text" id="license-key-input" class="license-screen-input" placeholder="VERBA-XXXX-XXXX-XXXX-XXXX" autocomplete="off" spellcheck="false" />
            <p id="license-error" class="license-screen-error" aria-live="polite"></p>
            <button type="button" id="license-activate-btn" class="btn btn-primary license-screen-btn">Activate</button>
        </div>
    </div>

    <div class="dashboard" id="dashboard-content">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <img src="icon.png" alt="Verba" class="sidebar-logo" />
                <span class="sidebar-title">Verba</span>
            </div>
            <ul class="sidebar-nav">
                <li>
                    <button class="nav-btn active" data-tab="stats">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="12" width="4" height="9" rx="1"/>
                            <rect x="10" y="7" width="4" height="14" rx="1"/>
                            <rect x="17" y="3" width="4" height="18" rx="1"/>
                        </svg>
                        <span>Stats</span>
                    </button>
                </li>
                <li>
                    <button class="nav-btn" data-tab="dictionary">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                            <line x1="8" y1="7" x2="16" y2="7"/>
                            <line x1="8" y1="11" x2="14" y2="11"/>
                        </svg>
                        <span>Dictionary</span>
                    </button>
                </li>
                <li>
                    <button class="nav-btn" data-tab="history">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12 6 12 12 16 14"/>
                        </svg>
                        <span>History</span>
                    </button>
                </li>
                <li>
                    <button class="nav-btn" data-tab="settings">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                        </svg>
                        <span>Settings</span>
                    </button>
                </li>
            </ul>
            <div class="sidebar-footer">
                <span class="version-label">v0.1.0</span>
            </div>
        </nav>

        <!-- Main content area -->
        <main class="main-content">

            <!-- ===== STATS TAB ===== -->
            <section id="tab-stats" class="tab-panel active">
                <div class="tab-header">
                    <h1>Statistics</h1>
                    <p class="tab-subtitle">Your voice dictation at a glance</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon purple">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                                <line x1="12" y1="19" x2="12" y2="23"/>
                                <line x1="8" y1="23" x2="16" y2="23"/>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-dictations">0</div>
                        <div class="stat-label">Total Dictations</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-words">0</div>
                        <div class="stat-label">Words Dictated</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-time-saved">0m</div>
                        <div class="stat-label">Time Saved</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                                <polyline points="17 6 23 6 23 12"/>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-avg-length">0</div>
                        <div class="stat-label">Avg Words / Dictation</div>
                    </div>
                </div>

                <div class="stat-card wide">
                    <h3>Recent Activity</h3>
                    <div id="recent-activity" class="recent-activity-list">
                        <div class="empty-state">No dictations yet. Start talking!</div>
                    </div>
                </div>
            </section>

            <!-- ===== DICTIONARY TAB ===== -->
            <section id="tab-dictionary" class="tab-panel">
                <div class="tab-header">
                    <h1>Dictionary</h1>
                    <p class="tab-subtitle">Custom words, replacements, and blocked phrases</p>
                </div>

                <div class="dictionary-controls">
                    <div class="search-box">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"/>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" id="dict-search" placeholder="Search dictionary..." />
                    </div>
                    <button class="btn btn-primary" id="btn-add-word">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        Add Entry
                    </button>
                </div>

                <!-- Add/Edit Form (hidden by default) -->
                <div id="dict-form" class="dict-form" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dict-phrase">Phrase</label>
                            <input type="text" id="dict-phrase" placeholder="e.g. Mercer Voice" />
                        </div>
                        <div class="form-group">
                            <label for="dict-replacement">Replacement (optional)</label>
                            <input type="text" id="dict-replacement" placeholder="e.g. MercerVoice" />
                        </div>
                        <div class="form-group form-group-type">
                            <label for="dict-type">Type</label>
                            <select id="dict-type">
                                <option value="custom">Custom Word</option>
                                <option value="replacement">Replacement</option>
                                <option value="blocked">Blocked</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-ghost" id="btn-cancel-word">Cancel</button>
                        <button class="btn btn-primary" id="btn-save-word">Save</button>
                    </div>
                </div>

                <div id="dict-list" class="dict-list">
                    <div class="empty-state">No dictionary entries yet. Add custom words and replacements.</div>
                </div>
            </section>

            <!-- ===== HISTORY TAB ===== -->
            <section id="tab-history" class="tab-panel">
                <div class="tab-header">
                    <h1>History</h1>
                    <p class="tab-subtitle">Your recent dictations</p>
                </div>

                <div class="dictionary-controls">
                    <div class="search-box">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"/>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" id="history-search" placeholder="Search history..." />
                    </div>
                    <button class="btn btn-ghost btn-danger" id="btn-clear-history">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="3 6 5 6 21 6"/>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                        Clear All
                    </button>
                </div>

                <div id="history-list" class="history-list">
                    <div class="empty-state">No history yet. Your dictations will appear here.</div>
                </div>
            </section>

            <!-- ===== SETTINGS TAB ===== -->
            <section id="tab-settings" class="tab-panel">
                <div class="tab-header">
                    <h1>Settings</h1>
                    <p class="tab-subtitle">Configure Verba to your liking</p>
                </div>

                <div class="settings-section">
                    <h3>General</h3>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Sound Effects</div>
                            <div class="setting-description">Play beep/boop when recording starts and stops</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="setting-sounds" checked />
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Auto-Paste</div>
                            <div class="setting-description">Automatically paste transcribed text into the active app</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="setting-auto-paste" checked />
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Launch at Login</div>
                            <div class="setting-description">Start Verba automatically when you log in</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="setting-launch-at-login" />
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Transcription</h3>
                    <p class="settings-section-desc">Choose where speech-to-text runs: in the cloud (Azure) or on this Mac (local model).</p>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Source</div>
                            <div class="setting-description">Azure uses your API key; Local uses an embedded model (no key required).</div>
                        </div>
                        <div class="transcription-source-toggle">
                            <label class="source-option">
                                <input type="radio" name="transcription-source" value="azure" id="source-azure" />
                                <span>Azure (cloud)</span>
                            </label>
                            <label class="source-option">
                                <input type="radio" name="transcription-source" value="local" id="source-local" />
                                <span>Local (this Mac)</span>
                            </label>
                        </div>
                    </div>
                    <div id="transcription-azure-fields" class="transcription-fields">
                        <div class="setting-row setting-row-stacked">
                            <div class="setting-info">
                                <div class="setting-name">Whisper Endpoint</div>
                                <div class="setting-description">Your Azure OpenAI Whisper deployment URL</div>
                            </div>
                            <input type="url" id="setting-api-endpoint" class="setting-input" placeholder="https://your-resource.openai.azure.com/openai/deployments/whisper/audio/transcriptions?api-version=2024-06-01" />
                        </div>
                        <div class="setting-row setting-row-stacked">
                            <div class="setting-info">
                                <div class="setting-name">API Key</div>
                                <div class="setting-description">Your Azure OpenAI API key</div>
                            </div>
                            <div class="api-key-row">
                                <input type="password" id="setting-api-key" class="setting-input" placeholder="Enter your API key" />
                                <button class="btn btn-ghost btn-sm" id="btn-toggle-key" title="Show/hide key">
                                    <svg id="icon-eye" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                        <circle cx="12" cy="12" r="3"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <span id="api-status" class="api-status"></span>
                            </div>
                            <button class="btn btn-primary btn-sm" id="btn-save-api">Save API Config</button>
                        </div>
                    </div>
                    <div id="transcription-local-fields" class="transcription-fields" style="display:none;">
                        <div class="setting-row setting-row-stacked">
                            <div class="setting-info">
                                <div class="setting-name">Model size</div>
                                <div class="setting-description">Larger models are more accurate but slower and use more disk space.</div>
                            </div>
                            <select id="setting-local-model-size" class="setting-input setting-select">
                                <option value="tiny">Tiny (~75 MB) — fastest</option>
                                <option value="small">Small (~466 MB)</option>
                                <option value="medium">Medium (~1.5 GB)</option>
                                <option value="large">Large (~2.9 GB) — best quality</option>
                            </select>
                        </div>
                        <div class="setting-row setting-row-stacked">
                            <div class="setting-info">
                                <div class="setting-name">Model path (optional)</div>
                                <div class="setting-description">Leave empty to use the default location for the size above.</div>
                            </div>
                            <input type="text" id="setting-local-model-path" class="setting-input" placeholder="Leave empty for default" />
                            <div class="local-model-help" id="local-model-default-path">Default: …</div>
                            <div class="local-model-download-row">
                                <button type="button" class="btn btn-primary btn-sm" id="btn-download-model">Download model</button>
                                <span id="model-download-status" class="api-status"></span>
                            </div>
                            <div id="model-download-progress-wrap" class="model-download-progress-wrap" style="display:none;">
                                <div class="model-download-progress-bar">
                                    <div id="model-download-progress-fill" class="model-download-progress-fill"></div>
                                </div>
                                <span id="model-download-progress-text" class="local-model-help">0%</span>
                            </div>
                            <div class="local-model-help" id="local-model-download-hint">Downloads the selected model into the default folder above.</div>
                        </div>
                        <div class="setting-row">
                            <div class="setting-info">
                                <span id="transcription-status" class="api-status"></span>
                            </div>
                            <button class="btn btn-primary btn-sm" id="btn-save-transcription">Save transcription settings</button>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Hotkey</h3>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Trigger Key</div>
                            <div class="setting-description" id="hotkey-description">
                                Press once to start recording, press again to stop and transcribe.
                            </div>
                            <p class="setting-description" style="margin-top:4px; font-size:11px; color:var(--colors--gray);">On Mac, if the shortcut doesn’t work when another app is focused, add Verba (or Electron) in System Settings → Privacy &amp; Security → Accessibility.</p>
                        </div>
                        <select id="hotkey-select" class="setting-input setting-select" style="max-width:220px;">
                            <option value="Fn">Fn (Globe key)</option>
                            <option value="Command+Shift+Space">Cmd + Shift + Space</option>
                            <option value="Control+Option+Space">Ctrl + Opt + Space</option>
                            <option value="Command+Option+Space">Cmd + Opt + Space</option>
                            <option value="Command+Shift+V">Cmd + Shift + V</option>
                            <option value="F5">F5</option>
                            <option value="F6">F6</option>
                            <option value="F7">F7</option>
                            <option value="F8">F8</option>
                        </select>
                        <p id="hotkey-status" class="setting-description" style="margin-top:6px;"></p>
                    </div>
                    <div class="setting-row" id="fn-key-note" style="display:none;">
                        <div class="setting-info">
                            <div class="setting-name">Globe / Fn key tip</div>
                            <div class="setting-description">Verba remaps the Globe key to F18 at the system level while running. To prevent the emoji picker from also opening, set <strong>"Press globe key to: Do Nothing"</strong> in System Settings &gt; Keyboard. The remap is automatically removed when Verba quits.</div>
                        </div>
                        <button type="button" class="btn btn-ghost btn-sm" id="btn-open-keyboard-settings">Open Keyboard Settings</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>About</h3>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Verba</div>
                            <div class="setting-description">Version 0.1.0 — Voice dictation for your desktop</div>
                        </div>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Pill hover when another app is focused</div>
                            <div class="setting-description">On Mac, the pill can expand on hover even when you're in another app. This requires Accessibility permission — add Verba in System Settings → Privacy &amp; Security → Accessibility.</div>
                        </div>
                        <button type="button" class="btn btn-ghost btn-sm" id="btn-open-accessibility">Open Accessibility Settings</button>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Microphone</div>
                            <div class="setting-description">Verba needs microphone access. Click "Request access" below. In development mode the app appears as "Electron" in System Settings &gt; Privacy &amp; Security &gt; Microphone — make sure it is enabled. If recording fails, open Microphone Settings and toggle Electron off then on, then restart Verba.</div>
                        </div>
                        <div class="setting-buttons">
                            <button type="button" class="btn btn-primary btn-sm" id="btn-request-microphone">Request access</button>
                            <button type="button" class="btn btn-ghost btn-sm" id="btn-open-microphone">Open Microphone Settings</button>
                        </div>
                    </div>
                    <div class="setting-row">
                        <div class="setting-info">
                            <div class="setting-name">Reset license</div>
                            <div class="setting-description">Deactivate this install and show the product key screen again (e.g. to test activation).</div>
                        </div>
                        <button type="button" class="btn btn-ghost btn-sm" id="btn-deactivate-license">Deactivate</button>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script src="js/dashboard.js"></script>

</body>
</html>
